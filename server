const express = require("express");
const app = express();
const nodemail = require("nodemailer");

// const sendMail = require("./mail/mail");

app.get("/",  function (req, res) {
    let body = req.query;
    var message = {
        text: body.message || "i hope this works",
        from: body.mailFrom || "pogorelovskiy_ma@surgutneftegas.ru",
        to: body.mailTo || "pogorelovskiy_ma@surgutneftegas.ru",
        subject: "testing emailjs"
    };

    let transporter = nodemail.createTransport(
        {
            auth: {
                user: body.user || "mdm@surgutneftegas.ru",
                password: body.pass || "17122018P@ssw0rd"
            },
            host: body.host || "forward.oao.sng",
            port: parseInt(body.port) || 25,
            pool: true,
            secure: true,
            sendmail: true,
              tls: {
    // do not fail on invalid certs
    rejectUnauthorized: false
  }
        }
    );


    transporter.sendMail(message, (err, info) => {
        if (err) {
            res.send(`${err.stack} \n user = ${body.user || "mdm@surgutneftegas.ru"} \n pass=${body.pass || "17122018P@ssw0rd"} \n host=${body.host || "forward.oao.sng"} \n ${parseInt(body.port) || 25}`);
            return ;
        }
        console.log('Message %s sent: %s', info.messageId, info.response);
        console.log(`message send or error`);
        res.send(`status: 200 \n message send or error`);
    });
});

const port = process.env.PORT || 13002;
app.listen(port, function () {
    console.log('Sample CORE api is running on port ' + port);
});



Error: Missing credentials for "PLAIN" at SMTPConnection._formatError (D:\development\NodeJS\app_core\node_modules\nodemailer\lib\smtp-connection\index.js:774:19) at SMTPConnection.login (D:\development\NodeJS\app_core\node_modules\nodemailer\lib\smtp-connection\index.js:445:38) at connection.connect (D:\development\NodeJS\app_core\node_modules\nodemailer\lib\smtp-transport\index.js:271:32) at SMTPConnection.once (D:\development\NodeJS\app_core\node_modules\nodemailer\lib\smtp-connection\index.js:200:17) at Object.onceWrapper (events.js:273:13) at SMTPConnection.emit (events.js:182:13) at SMTPConnection._actionEHLO (D:\development\NodeJS\app_core\node_modules\nodemailer\lib\smtp-connection\index.js:1302:14) at SMTPConnection._processResponse (D:\development\NodeJS\app_core\node_modules\nodemailer\lib\smtp-connection\index.js:933:20) at SMTPConnection._onData (D:\development\NodeJS\app_core\node_modules\nodemailer\lib\smtp-connection\index.js:739:14) at TLSSocket._socket.on.chunk (D:\development\NodeJS\app_core\node_modules\nodemailer\lib\smtp-connection\index.js:879:55) user = mdm@surgutneftegas.ru pass=17122018P@ssw0rd host=forward.oao.sng 25
